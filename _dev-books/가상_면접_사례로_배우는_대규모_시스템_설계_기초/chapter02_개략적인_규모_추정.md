# chapter02.개략적인 규모 추정

1. 2의 제곱수 : 데이터 볼륨을 추정하기 위한 수단
2. 응답지연 값 : 대략적인 컴퓨터 지연 시간을 위한 수단

## 1. 2의 제곱수

- 데이터 볼륨을 추정하기 위해 2의 제곱 수를 사용한다.
- ASCII 문자가 하나가 차지하는 메모리 크기는 1Byte(8bit) 이다.
- 근사치 그래프

| 2의 제곱수 | 근사치   | 이름     | 축양형 |
|--------|-------|--------|-----|
| 10     | 1천    | 1킬로바이트 | 1KB |
| 20     | 1백만   | 1킬로바이트 | 1MB |
| 30     | 10억   | 1기가바이트 | 1GB |
| 40     | 1조    | 1테라바이트 | 1TB |
| 50     | 1000조 | 1페타바이트 | 1PB |

<br>

## 2. 컴퓨터의 통상적인 응답 지연 값

1. 2010년 구글의 제프 딘이 컴퓨터의 응답지연 값을 공개했다. 이를 통대 대략적인 컴퓨터 연산의 처리 속도를 짐작할 수 있다.

| 연산명                                | 시간                     |
|------------------------------------|------------------------|
| L1 캐시 참조                           | 0.5 ns                 |
| 분기 예측 오류                           | 5 ns                   |
| L2 캐시 참조                           | 7 ns                   |
| 뮤텍스(mutext) 락 / 언락                 | 100 ns                 |
| 주 메모리 참조                           | 100 ns                 |
| 1Gbps 네트워크로 2KB 전송                 | 2 * 10^4 ns = 20 µs    |
| 메모리에서 1MB 순차적으로 Read               | 2.5 * 10^5 ns = 250 µs | 
| 같은 데이터 센터 내에서의 메세지 왕복 지연시간         | 5 * 10^5 ns = 500 µs   | 
| 디스크 탐색(seek)                       | 1 * 10^7 ns = 10 ms    |
| 네트워크에서 1MB 순차적으로 read              | 1 * 10^7 ns = 10 ms    |
| 디스크에서 1MB 순차적으로 read               | 3 * 10^7 ns = 30 ms    |
| 한 패킷의 CA(캘리포니아) 부터 네덜란드까지의 왕복 지연시간 | 1.5 * 10^8 ns = 150 ms |

2. 수치 분석 결론
   1. 메모리는 빠르지만 디스크는 느리다.
   2. 디스크 탐색(seek)은 가능한 피하라.
   3. 단순한 압축 알고리즘은 빠르다.
   4. 데이터를 인터넷으로 전송하기 전에 가능하면 압축하라.
   5. 데이터 센터는 보통 여러 지역(region)에 분산되어 있고, 센터들 간에 데이터를 주고받는 데는 시간이 걸린다.

<br>

## 3. 가용성에 관계된 수치들

1. 고가용성(high availability) : 오랜 시간동안 지속적으로 중단 없이 운영될 수 있는 능력
2. 대부분의 서비스는 99% 에서 100% 사이이며, 가용시간은 관습적으로 숫자 9를 사용한다. (9가 많을수록 좋다.)
3. 트위터 QPS & 저장소 요구량
   1. QPS(Query Per Second) 추정치
       - 일간 능돌 사용자 : 3억 * 50%(매일 사용하는 사용자 비율) = 1.5억
       - QPS = 1.5억 * 2 트윗 / 24 * 3600 = 약 3500
       - 최대 QPS(Peek QPS) = 2 * QPS = 7000
    2. 미디어 저장을 위한 저장소 요구량
        - 평균 트윗 크기 : tweet_id(64 byte) + 텍스트(140 byte) + 미디어 (1 MB)
        - 미디어 저장소 요구량 : 1.5억 * 2 * 1/10 * 1(MB) = 30TB / 일
        - 5년간 미디어 보관을 위한 저장소 요구량 : 30TB * 365 * 5 = 55PB
          - 대략적인 저장소 요구량을 위해서는 작은 값은 쳐낸다.

<br>

